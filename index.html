<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vive Artigas - Artigas, Uruguay</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script src="https://cdn.tailwindcss.com/3.4.1"></script>
    <style>
        :root {
            --primary: #1e3a8a;
            --secondary: #facc15;
            --gradient: linear-gradient(135deg, #1e3a8a, #3b82f6);
        }
        .property-card, .agency-card, .neighborhood-card {
            transition: transform 0.3s, box-shadow 0.3s;
            animation: fadeIn 0.5s ease-in;
        }
        .property-card:hover, .agency-card:hover, .neighborhood-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        .fade-in { animation: fadeIn 1s ease-in; }
        .slide-in { animation: slideIn 0.5s ease-out; }
        .pulse { animation: pulse 1.5s infinite; }
        label.required::after { content: ' *'; color: #dc2626; }
        .chat-bubble {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--gradient);
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slideIn {
            from { transform: translateX(-100%); }
            to { transform: translateX(0); }
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body class="bg-gray-100">
    <div id="root"></div>
    <div class="chat-bubble pulse" onclick="openChat()">Soporte en Vivo</div>
    <script src="https://unpkg.com/react@18.2.0/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/react-router-dom@5.3.4/umd/react-router-dom.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone@7.23.9/babel.min.js"></script>
    <script type="text/babel">
        const { BrowserRouter, Route, Switch, Link, useParams, useHistory } = ReactRouterDOM;

        // Simulated backend for scalability
        const citiesData = [
            { id: 1, name: "Artigas", coordinates: { lat: -30.4000, lng: -56.4667 } },
            { id: 2, name: "Montevideo", coordinates: { lat: -34.9011, lng: -56.1645 } }
        ];

        const propertiesData = [
            { id: 1, type: "Casa", title: "Casa Céntrica en Artigas", description: "Casa de 3 dormitorios cerca de Plaza Artigas.", price: 25000, location: "Centro, Artigas", cityId: 1, bedrooms: 3, bathrooms: 2, area: 120, yearBuilt: 2010, amenities: ["jardín", "garaje"], images: ["https://via.placeholder.com/600x400?text=Casa+Artigas+1"], pointsOfInterest: ["Plaza Artigas", "Escuela"], agencyId: 1, isFeatured: true, sponsored: true },
            { id: 2, type: "Apartamento", title: "Apartamento Moderno", description: "Apartamento nuevo en Barrio Norte.", price: 18000, location: "Norte, Artigas", cityId: 1, bedrooms: 2, bathrooms: 1, area: 80, yearBuilt: 2020, amenities: ["balcón"], images: ["https://via.placeholder.com/600x400?text=Apartamento+1"], pointsOfInterest: ["Supermercado"], agencyId: null, isFeatured: false, sponsored: false }
        ];

        const agenciesData = [
            { id: 1, name: "Inmobiliaria Artigas", logo: "https://via.placeholder.com/100?text=Logo+Artigas", description: "Expertos en propiedades de Artigas desde 2010.", images: ["https://via.placeholder.com/300?text=Office+1"], plan: "Pro", contact: "098-123-456", website: "https://example.com" }
        ];

        const servicesData = [
            { id: 1, name: "Plomería Artigas", category: "Plomería", contact: "098-123-456", description: "Reparaciones 24/7 en Artigas.", cityId: 1 }
        ];

        const neighborhoodsData = [
            { id: 1, name: "Centro", description: "Corazón de Artigas con acceso a Plaza Artigas y comercios.", amenities: ["Plaza Artigas", "Escuela", "Supermercado"], coordinates: { lat: -30.4000, lng: -56.4667 }, cityId: 1 }
        ];

        const usersData = [
            { id: 1, username: "admin", password: "admin123", role: "admin" },
            { id: 2, username: "user1", password: "user123", role: "user" }
        ];

        // Simulated AI recommendations
        function getAIRecommendations(userId, properties) {
            return properties.filter(p => p.isFeatured || p.sponsored).slice(0, 3);
        }

        function Header() {
            const [user, setUser] = React.useState(null);
            const history = useHistory();

            const handleLogout = () => {
                setUser(null);
                history.push('/');
            };

            return (
                <header className="bg-gradient-to-r from-blue-900 to-blue-600 text-white p-4 shadow-lg">
                    <nav className="container mx-auto flex justify-between items-center">
                        <Link to="/" className="text-2xl font-bold hover:text-yellow-300 transition-colors">Vive Artigas</Link>
                        <div className="flex items-center space-x-4">
                            <Link to="/" className="hover:text-yellow-300 transition-colors">Inicio</Link>
                            <Link to="/list" className="hover:text-yellow-300 transition-colors">Publicar Propiedad</Link>
                            <Link to="/agencies" className="hover:text-yellow-300 transition-colors">Inmobiliarias</Link>
                            <Link to="/services" className="hover:text-yellow-300 transition-colors">Servicios</Link>
                            <Link to="/neighborhoods" className="hover:text-yellow-300 transition-colors">Barrios</Link>
                            <Link to="/plans" className="hover:text-yellow-300 transition-colors">Planes</Link>
                            {user ? (
                                <>
                                    <Link to="/profile" className="hover:text-yellow-300 transition-colors">{user.username}</Link>
                                    <button onClick={handleLogout} className="hover:text-yellow-300">Cerrar Sesión</button>
                                </>
                            ) : (
                                <Link to="/login" className="hover:text-yellow-300 transition-colors">Iniciar Sesión</Link>
                            )}
                        </div>
                    </nav>
                </header>
            );
        }

        function Footer() {
            return (
                <footer className="bg-gray-900 text-white p-4 text-center mt-auto">
                    <p>© 2025 Vive Artigas - Uruguay. <a href="/affiliates" className="text-yellow-300">Afiliados</a> | <a href="/ads" className="text-yellow-300">Publicidad</a></p>
                </footer>
            );
        }

        function LoginPage() {
            const [username, setUsername] = React.useState('');
            const [password, setPassword] = React.useState('');
            const [error, setError] = React.useState('');
            const history = useHistory();

            const handleLogin = (e) => {
                e.preventDefault();
                const user = usersData.find(u => u.username === username && u.password === password);
                if (user) {
                    localStorage.setItem('user', JSON.stringify(user));
                    history.push(user.role === 'admin' ? '/admin' : '/');
                } else {
                    setError('Credenciales incorrectas');
                }
            };

            return (
                <div className="container mx-auto p-4 fade-in">
                    <h1 className="text-3xl font-bold text-center mb-6">Iniciar Sesión</h1>
                    <form onSubmit={handleLogin} className="bg-white p-6 rounded-lg shadow-md max-w-md mx-auto">
                        <div className="mb-4">
                            <label className="block text-sm font-medium text-gray-700 required">Usuario:</label>
                            <input
                                type="text"
                                value={username}
                                onChange={(e) => setUsername(e.target.value)}
                                className="mt-1 w-full p-2 border border-gray-300 rounded-md"
                            />
                        </div>
                        <div className="mb-4">
                            <label className="block text-sm font-medium text-gray-700 required">Contraseña:</label>
                            <input
                                type="password"
                                value={password}
                                onChange={(e) => setPassword(e.target.value)}
                                className="mt-1 w-full p-2 border border-gray-300 rounded-md"
                            />
                        </div>
                        {error && <p className="text-red-500 text-sm mb-4">{error}</p>}
                        <button type="submit" className="w-full bg-blue-600 text-white p-3 rounded-lg hover:bg-blue-700">Iniciar Sesión</button>
                    </form>
                </div>
            );
        }

        function ProfilePage() {
            const user = JSON.parse(localStorage.getItem('user'));
            const history = useHistory();
            if (!user) {
                history.push('/login');
                return null;
            }

            return (
                <div className="container mx-auto p-4 fade-in">
                    <h1 className="text-3xl font-bold mb-6">Perfil de {user.username}</h1>
                    <div className="bg-white p-6 rounded-lg shadow-md">
                        <p className="text-gray-700 mb-4"><strong>Rol:</strong> {user.role}</p>
                        <Link to="/edit-profile" className="inline-block bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Editar Perfil</Link>
                    </div>
                </div>
            );
        }

        function AdminPage() {
            const user = JSON.parse(localStorage.getItem('user'));
            const history = useHistory();
            if (!user || user.role !== 'admin') {
                history.push('/login');
                return null;
            }

            const handleDeleteProperty = (id) => {
                propertiesData.splice(propertiesData.findIndex(p => p.id === id), 1);
                alert('Propiedad eliminada (simulada).');
            };

            return (
                <div className="container mx-auto p-4 fade-in">
                    <h1 className="text-3xl font-bold mb-6">Panel de Administración</h1>
                    <h2 className="text-2xl font-semibold mb-4">Gestionar Propiedades</h2>
                    <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                        {propertiesData.map(prop => (
                            <div key={prop.id} className="bg-white p-4 rounded-lg shadow-md">
                                <h3 className="text-xl font-semibold">{prop.title}</h3>
                                <p className="text-gray-600">{prop.location}</p>
                                <button onClick={() => handleDeleteProperty(prop.id)} className="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 mt-2">Eliminar</button>
                            </div>
                        ))}
                    </div>
                </div>
            );
        }

        function HomePage() {
            const [searchTerm, setSearchTerm] = React.useState('');
            const [filterType, setFilterType] = React.useState('');
            const [filterMinPrice, setFilterMinPrice] = React.useState('');
            const [filterMaxPrice, setFilterMaxPrice] = React.useState('');
            const [filterPointOfInterest, setFilterPointOfInterest] = React.useState('');
            const [showFilters, setShowFilters] = React.useState(false);
            const [selectedCity, setSelectedCity] = React.useState(1); // Artigas by default
            const user = JSON.parse(localStorage.getItem('user'));

            const filteredProperties = propertiesData.filter(prop => {
                return (
                    prop.cityId === selectedCity &&
                    (prop.title.toLowerCase().includes(searchTerm.toLowerCase()) ||
                     prop.location.toLowerCase().includes(searchTerm.toLowerCase()) ||
                     prop.description.toLowerCase().includes(searchTerm.toLowerCase()) ||
                     prop.type.toLowerCase().includes(searchTerm.toLowerCase())) &&
                    (!filterType || prop.type === filterType) &&
                    (!filterMinPrice || prop.price >= parseFloat(filterMinPrice)) &&
                    (!filterMaxPrice || prop.price <= parseFloat(filterMaxPrice)) &&
                    (!filterPointOfInterest || prop.pointsOfInterest.includes(filterPointOfInterest))
                );
            });

            const aiRecommendations = user ? getAIRecommendations(user.id, filteredProperties) : [];

            return (
                <div className="container mx-auto p-4 fade-in">
                    <h1 className="text-4xl font-bold text-center mb-6 text-blue-900">Vive en Uruguay</h1>
                    <p className="text-center text-gray-600 mb-6">Encuentra tu hogar ideal en cualquier ciudad de Uruguay.</p>

                    <div className="mb-6 p-6 bg-white rounded-lg shadow-lg">
                        <div className="mb-4">
                            <label className="block text-sm font-medium text-gray-700">Ciudad:</label>
                            <select
                                value={selectedCity}
                                onChange={(e) => setSelectedCity(parseInt(e.target.value))}
                                className="w-full p-2 border border-gray-300 rounded-md"
                            >
                                {citiesData.map(city => (
                                    <option key={city.id} value={city.id}>{city.name}</option>
                                ))}
                            </select>
                        </div>
                        <input
                            type="text"
                            placeholder="Buscar por título, ubicación, tipo..."
                            value={searchTerm}
                            onChange={(e) => setSearchTerm(e.target.value)}
                            className="w-full p-3 mb-4 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                        />
                        <button
                            onClick={() => setShowFilters(!showFilters)}
                            className="w-full sm:w-auto bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 pulse"
                        >
                            {showFilters ? 'Ocultar Filtros' : 'Filtros Avanzados'}
                        </button>
                        {showFilters && (
                            <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mt-4 slide-in">
                                <div>
                                    <label className="block text-sm font-medium text-gray-700">Tipo:</label>
                                    <select value={filterType} onChange={(e) => setFilterType(e.target.value)} className="w-full p-2 border border-gray-300 rounded-md">
                                        <option value="">Todos</option>
                                        <option value="Casa">Casa</option>
                                        <option value="Apartamento">Apartamento</option>
                                    </select>
                                </div>
                                <div>
                                    <label className="block text-sm font-medium text-gray-700">Precio Mínimo (UYU):</label>
                                    <input type="number" value={filterMinPrice} onChange={(e) => setFilterMinPrice(e.target.value)} className="w-full p-2 border border-gray-300 rounded-md" />
                                </div>
                                <div>
                                    <label className="block text-sm font-medium text-gray-700">Precio Máximo (UYU):</label>
                                    <input type="number" value={filterMaxPrice} onChange={(e) => setFilterMaxPrice(e.target.value)} className="w-full p-2 border border-gray-300 rounded-md" />
                                </div>
                                <div>
                                    <label className="block text-sm font-medium text-gray-700">Cerca de:</label>
                                    <select value={filterPointOfInterest} onChange={(e) => setFilterPointOfInterest(e.target.value)} className="w-full p-2 border border-gray-300 rounded-md">
                                        <option value="">Todos</option>
                                        <option value="Plaza Artigas">Plaza Artigas</option>
                                        <option value="Escuela">Escuela</option>
                                        <option value="Supermercado">Supermercado</option>
                                    </select>
                                </div>
                            </div>
                        )}
                    </div>

                    {user && aiRecommendations.length > 0 && (
                        <div>
                            <h2 className="text-2xl font-semibold mb-4 text-blue-900">Recomendaciones para Ti</h2>
                            <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                                {aiRecommendations.map(prop => (
                                    <div key={prop.id} className="property-card bg-white rounded-lg shadow-lg overflow-hidden flex flex-col">
                                        <img src={prop.images[0]} alt={prop.title} className="w-full h-48 object-cover" />
                                        <div className="p-4 flex-grow flex flex-col justify-between">
                                            <div>
                                                <span className="inline-block bg-yellow-200 text-yellow-800 text-xs px-2 rounded-full mb-1">{prop.type}</span>
                                                <h3 className="text-xl font-semibold mb-1">{prop.title}</h3>
                                                <p className="text-gray-600 text-sm mb-2">{prop.location}</p>
                                                <div className="text-gray-700 text-sm mb-3">
                                                    <span>{prop.bedrooms} <i className="fas fa-bed"></i></span> | 
                                                    <span>{prop.bathrooms} <i className="fas fa-bath"></i></span> | 
                                                    <span>{prop.area} m²</span>
                                                </div>
                                            </div>
                                            <div>
                                                <p className="text-2xl font-bold text-blue-600 mb-3">UYU {prop.price}/mes</p>
                                                <Link to={`/property/${prop.id}`} className="block text-center bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Ver Detalles</Link>
                                            </div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}

                    <h2 className="text-2xl font-semibold mb-4 text-blue-900">Propiedades Destacadas</h2>
                    <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                        {filteredProperties.filter(p => p.isFeatured).slice(0, 3).map(prop => (
                            <div key={prop.id} className="property-card bg-white rounded-lg shadow-lg overflow-hidden flex flex-col">
                                {prop.sponsored && <span className="absolute bg-yellow-400 text-white text-xs px-2 py-1">Patrocinado</span>}
                                <img src={prop.images[0]} alt={prop.title} className="w-full h-48 object-cover" />
                                <div className="p-4 flex-grow flex flex-col justify-between">
                                    <div>
                                        <span className="inline-block bg-yellow-200 text-yellow-800 text-xs px-2 rounded-full mb-1">{prop.type}</span>
                                        <h3 className="text-xl font-semibold mb-1">{prop.title}</h3>
                                        <p className="text-gray-600 text-sm mb-2">{prop.location}</p>
                                        <div className="text-gray-700 text-sm mb-3">
                                            <span>{prop.bedrooms} <i className="fas fa-bed"></i></span> | 
                                            <span>{prop.bathrooms} <i className="fas fa-bath"></i></span> | 
                                            <span>{prop.area} m²</span>
                                        </div>
                                    </div>
                                    <div>
                                        <p className="text-2xl font-bold text-blue-600 mb-3">UYU {prop.price}/mes</p>
                                        <Link to={`/property/${prop.id}`} className="block text-center bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Ver Detalles</Link>
                                    </div>
                                </div>
                            </div>
                        ))}
                    </div>

                    <div className="bg-white p-6 rounded-lg shadow-md mb-8">
                        <h2 className="text-2xl font-semibold mb-4 text-blue-900">Anuncios</h2>
                        <p className="text-gray-700">¡Promociona tu negocio aquí! <a href="/ads" className="text-blue-600">Más información</a></p>
                    </div>
                </div>
            );
        }

        function PropertyPage() {
            const { id } = useParams();
            const property = propertiesData.find(p => p.id === parseInt(id));
            if (!property) return <div className="container mx-auto p-4 fade-in">Propiedad no encontrada</div>;
            const agency = agenciesData.find(a => a.id === property.agencyId);
            return (
                <div className="container mx-auto p-4 fade-in">
                    <h1 className="text-3xl font-bold mb-6 text-blue-900">{property.title}</h1>
                    <img src={property.images[0]} alt={property.title} className="w-full h-96 object-cover rounded-lg mb-4" />
                    <p className="text-gray-700 mb-4">{property.description}</p>
                    <p className="text-2xl font-bold text-blue-600 mb-4">UYU {property.price}/mes</p>
                    <p className="text-gray-600 mb-2"><strong>Ubicación:</strong> {property.location}</p>
                    <p className="text-gray-600 mb-2"><strong>Dormitorios:</strong> {property.bedrooms}</p>
                    <p className="text-gray-600 mb-2"><strong>Baños:</strong> {property.bathrooms}</p>
                    <p className="text-gray-600 mb-2"><strong>Área:</strong> {property.area} m²</p>
                    <p className="text-gray-600 mb-4"><strong>Puntos de Interés:</strong> {property.pointsOfInterest.join(', ')}</p>
                    {agency && (
                        <div className="bg-white p-4 rounded-lg shadow-md mb-4">
                            <h3 className="text-xl font-semibold mb-2">Publicado por: {agency.name}</h3>
                            <img src={agency.logo} alt={agency.name} className="w-24 h-24 object-contain mb-2" />
                            <p className="text-gray-600">{agency.description}</p>
                            <p className="text-blue-600">Contacto: {agency.contact}</p>
                        </div>
                    )}
                    <Link to="/" className="inline-block bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Volver</Link>
                </div>
            );
        }

        function ListPropertyPage() {
            const [formData, setFormData] = React.useState({
                type: '', title: '', description: '', price: '', location: '', cityId: 1, bedrooms: '', bathrooms: '', area: '', amenities: [], images: [''], pointsOfInterest: [], isFeatured: false, sponsored: false
            });
            const [errors, setErrors] = React.useState({});
            const history = useHistory();
            const user = JSON.parse(localStorage.getItem('user'));

            if (!user) {
                history.push('/login');
                return null;
            }

            const handleSubmit = (e) => {
                e.preventDefault();
                const newErrors = {};
                if (!formData.type) newErrors.type = 'El tipo es obligatorio.';
                if (!formData.title) newErrors.title = 'El título es obligatorio.';
                if (!formData.price) newErrors.price = 'El precio es obligatorio.';
                if (!formData.location) newErrors.location = 'La ubicación es obligatoria.';
                setErrors(newErrors);
                if (Object.keys(newErrors).length > 0) return;
                propertiesData.push({ id: Date.now(), ...formData, agencyId: user.role === 'agency' ? user.id : null });
                alert('Propiedad publicada (simulada).');
                history.push('/');
            };

            const handleAmenityChange = (amenity) => {
                setFormData({
                    ...formData,
                    amenities: formData.amenities.includes(amenity)
                        ? formData.amenities.filter(a => a !== amenity)
                        : [...formData.amenities, amenity]
                });
            };

            const handlePoiChange = (poi) => {
                setFormData({
                    ...formData,
                    pointsOfInterest: formData.pointsOfInterest.includes(poi)
                        ? formData.pointsOfInterest.filter(p => p !== poi)
                        : [...formData.pointsOfInterest, poi]
                });
            };

            return (
                <div className="container mx-auto p-4 fade-in">
                    <h1 className="text-3xl font-bold mb-6 text-blue-900">Publicar Propiedad</h1>
                    <form onSubmit={handleSubmit} className="bg-white p-6 rounded-lg shadow-md space-y-4">
                        <div>
                            <label className="block text-sm font-medium text-gray-700 required">Ciudad:</label>
                            <select
                                value={formData.cityId}
                                onChange={(e) => setFormData({ ...formData, cityId: parseInt(e.target.value) })}
                                className="mt-1 w-full p-2 border border-gray-300 rounded-md"
                            >
                                {citiesData.map(city => (
                                    <option key={city.id} value={city.id}>{city.name}</option>
                                ))}
                            </select>
                        </div>
                        <div>
                            <label className="block text-sm font-medium text-gray-700 required">Tipo:</label>
                            <select
                                value={formData.type}
                                onChange={(e) => setFormData({ ...formData, type: e.target.value })}
                                className="mt-1 w-full p-2 border border-gray-300 rounded-md"
                            >
                                <option value="">Selecciona</option>
                                <option value="Casa">Casa</option>
                                <option value="Apartamento">Apartamento</option>
                            </select>
                            {errors.type && <p className="text-red-500 text-sm mt-1">{errors.type}</p>}
                        </div>
                        <div>
                            <label className="block text-sm font-medium text-gray-700 required">Título:</label>
                            <input
                                type="text"
                                value={formData.title}
                                onChange={(e) => setFormData({ ...formData, title: e.target.value })}
                                className="mt-1 w-full p-2 border border-gray-300 rounded-md"
                            />
                            {errors.title && <p className="text-red-500 text-sm mt-1">{errors.title}</p>}
                        </div>
                        <div>
                            <label className="block text-sm font-medium text-gray-700">Descripción:</label>
                            <textarea
                                value={formData.description}
                                onChange={(e) => setFormData({ ...formData, description: e.target.value })}
                                className="mt-1 w-full p-2 border border-gray-300 rounded-md"
                                rows="4"
                            ></textarea>
                        </div>
                        <div>
                            <label className="block text-sm font-medium text-gray-700 required">Precio (UYU):</label>
                            <input
                                type="number"
                                value={formData.price}
                                onChange={(e) => setFormData({ ...formData, price: e.target.value })}
                                className="mt-1 w-full p-2 border border-gray-300 rounded-md"
                            />
                            {errors.price && <p className="text-red-500 text-sm mt-1">{errors.price}</p>}
                        </div>
                        <div>
                            <label className="block text-sm font-medium text-gray-700 required">Ubicación:</label>
                            <input
                                type="text"
                                value={formData.location}
                                onChange={(e) => setFormData({ ...formData, location: e.target.value })}
                                className="mt-1 w-full p-2 border border-gray-300 rounded-md"
                            />
                            {errors.location && <p className="text-red-500 text-sm mt-1">{errors.location}</p>}
                        </div>
                        <div>
                            <label className="block text-sm font-medium text-gray-700">Dormitorios:</label>
                            <input
                                type="number"
                                value={formData.bedrooms}
                                onChange={(e) => setFormData({ ...formData, bedrooms: e.target.value })}
                                className="mt-1 w-full p-2 border border-gray-300 rounded-md"
                            />
                        </div>
                        <div>
                            <label className="block text-sm font-medium text-gray-700">Baños:</label>
                            <input
                                type="number"
                                value={formData.bathrooms}
                                onChange={(e) => setFormData({ ...formData, bathrooms: e.target.value })}
                                className="mt-1 w-full p-2 border border-gray-300 rounded-md"
                            />
                        </div>
                        <div>
                            <label className="block text-sm font-medium text-gray-700">Área (m²):</label>
                            <input
                                type="number"
                                value={formData.area}
                                onChange={(e) => setFormData({ ...formData, area: e.target.value })}
                                className="mt-1 w-full p-2 border border-gray-300 rounded-md"
                            />
                        </div>
                        <div>
                            <label className="block text-sm font-medium text-gray-700">Comodidades:</label>
                            <div className="flex flex-wrap gap-4">
                                {['jardín', 'garaje', 'balcón', 'piscina'].map(amenity => (
                                    <label key={amenity} className="flex items-center">
                                        <input
                                            type="checkbox"
                                            checked={formData.amenities.includes(amenity)}
                                            onChange={() => handleAmenityChange(amenity)}
                                            className="mr-2"
                                        />
                                        {amenity}
                                    </label>
                                ))}
                            </div>
                        </div>
                        <div>
                            <label className="block text-sm font-medium text-gray-700">Puntos de Interés:</label>
                            <div className="flex flex-wrap gap-4">
                                {['Plaza Artigas', 'Escuela', 'Supermercado'].map(poi => (
                                    <label key={poi} className="flex items-center">
                                        <input
                                            type="checkbox"
                                            checked={formData.pointsOfInterest.includes(poi)}
                                            onChange={() => handlePoiChange(poi)}
                                            className="mr-2"
                                        />
                                        {poi}
                                    </label>
                                ))}
                            </div>
                        </div>
                        <div>
                            <label className="block text-sm font-medium text-gray-700">Imagen (URL):</label>
                            <input
                                type="url"
                                value={formData.images[0]}
                                onChange={(e) => setFormData({ ...formData, images: [e.target.value] })}
                                className="mt-1 w-full p-2 border border-gray-300 rounded-md"
                            />
                        </div>
                        <div>
                            <label className="block text-sm font-medium text-gray-700">Destacar Propiedad ($5):</label>
                            <input
                                type="checkbox"
                                checked={formData.isFeatured}
                                onChange={(e) => setFormData({ ...formData, isFeatured: e.target.checked })}
                                className="mr-2"
                            />
                        </div>
                        <div>
                            <label className="block text-sm font-medium text-gray-700">Patrocinar Propiedad ($10):</label>
                            <input
                                type="checkbox"
                                checked={formData.sponsored}
                                onChange={(e) => setFormData({ ...formData, sponsored: e.target.checked })}
                                className="mr-2"
                            />
                        </div>
                        <button type="submit" className="w-full bg-blue-600 text-white p-3 rounded-lg hover:bg-blue-700 pulse">Publicar Propiedad</button>
                    </form>
                </div>
            );
        }

        function AgenciesPage() {
            const [selectedCity, setSelectedCity] = React.useState(1);
            return (
                <div className="container mx-auto p-4 fade-in">
                    <h1 className="text-3xl font-bold text-center mb-6 text-blue-900">Inmobiliarias en Uruguay</h1>
                    <div className="mb-4">
                        <label className="block text-sm font-medium text-gray-700">Ciudad:</label>
                        <select
                            value={selectedCity}
                            onChange={(e) => setSelectedCity(parseInt(e.target.value))}
                            className="w-full p-2 border border-gray-300 rounded-md"
                        >
                            {citiesData.map(city => (
                                <option key={city.id} value={city.id}>{city.name}</option>
                            ))}
                        </select>
                    </div>
                    <Link to="/create-agency" className="inline-block bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 mb-6 pulse">Crear Perfil Inmobiliaria</Link>
                    <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                        {agenciesData.map(agency => (
                            <div key={agency.id} className="agency-card bg-white p-4 rounded-lg shadow-md">
                                <img src={agency.logo} alt={agency.name} className="w-24 h-24 object-contain mx-auto mb-4" />
                                <h3 className="text-xl font-semibold text-center mb-2">{agency.name}</h3>
                                <p className="text-gray-600 text-center mb-2">{agency.description}</p>
                                <p className="text-gray-600 text-center mb-2"><strong>Plan:</strong> {agency.plan}</p>
                                <p className="text-blue-600 text-center mb-2"><strong>Contacto:</strong> {agency.contact}</p>
                                <a href={agency.website} target="_blank" className="text-blue-500 text-center block mb-2">Visitar sitio web</a>
                                <Link to={`/agency/${agency.id}`} className="block text-center bg-blue-600 text-white px-4 py-2 rounded mt-4 hover:bg-blue-700">Ver Perfil</Link>
                            </div>
                        ))}
                    </div>
                </div>
            );
        }

        function CreateAgencyPage() {
            const [formData, setFormData] = React.useState({
                name: '', logo: '', description: '', images: [''], plan: 'Básico', contact: '', website: '', cityId: 1
            });
            const [errors, setErrors] = React.useState({});
            const history = useHistory();
            const user = JSON.parse(localStorage.getItem('user'));

            if (!user) {
                history.push('/login');
                return null;
            }

            const handleSubmit = (e) => {
                e.preventDefault();
                const newErrors = {};
                if (!formData.name) newErrors.name = 'El nombre es obligatorio.';
                if (!formData.description) newErrors.description = 'La descripción es obligatoria.';
                if (!formData.contact) newErrors.contact = 'El contacto es obligatorio.';
                setErrors(newErrors);
                if (Object.keys(newErrors).length > 0) return;
                agenciesData.push({ id: Date.now(), ...formData });
                alert('Perfil de inmobiliaria creado (simulado).');
                history.push('/agencies');
            };

            return (
                <div className="container mx-auto p-4 fade-in">
                    <h1 className="text-3xl font-bold mb-6 text-blue-900">Crear Perfil de Inmobiliaria</h1>
                    <form onSubmit={handleSubmit} className="bg-white p-6 rounded-lg shadow-md space-y-4">
                        <div>
                            <label className="block text-sm font-medium text-gray-700 required">Ciudad:</label>
                            <select
                                value={formData.cityId}
                                onChange={(e) => setFormData({ ...formData, cityId: parseInt(e.target.value) })}
                                className="mt-1 w-full p-2 border border-gray-300 rounded-md"
                            >
                                {citiesData.map(city => (
                                    <option key={city.id} value={city.id}>{city.name}</option>
                                ))}
                            </select>
                        </div>
                        <div>
                            <label className="block text-sm font-medium text-gray-700 required">Nombre:</label>
                            <input
                                type="text"
                                value={formData.name}
                                onChange={(e) => setFormData({ ...formData, name: e.target.value })}
                                className="mt-1 w-full p-2 border border-gray-300 rounded-md"
                            />
                            {errors.name && <p className="text-red-500 text-sm mt-1">{errors.name}</p>}
                        </div>
                        <div>
                            <label className="block text-sm font-medium text-gray-700">Logo (URL):</label>
                            <input
                                type="url"
                                value={formData.logo}
                                onChange={(e) => setFormData({ ...formData, logo: e.target.value })}
                                className="mt-1 w-full p-2 border border-gray-300 rounded-md"
                            />
                        </div>
                        <div>
                            <label className="block text-sm font-medium text-gray-700 required">Descripción:</label>
                            <textarea
                                value={formData.description}
                                onChange={(e) => setFormData({ ...formData, description: e.target.value })}
                                className="mt-1 w-full p-2 border border-gray-300 rounded-md"
                                rows="4"
                            ></textarea>
                            {errors.description && <p className="text-red-500 text-sm mt-1">{errors.description}</p>}
                        </div>
                        <div>
                            <label className="block text-sm font-medium text-gray-700">Imágenes (URL):</label>
                            <input
                                type="url"
                                value={formData.images[0]}
                                onChange={(e) => setFormData({ ...formData, images: [e.target.value] })}
                                className="mt-1 w-full p-2 border border-gray-300 rounded-md"
                            />
                        </div>
                        <div>
                            <label className="block text-sm font-medium text-gray-700">Plan:</label>
                            <select
                                value={formData.plan}
                                onChange={(e) => setFormData({ ...formData, plan: e.target.value })}
                                className="mt-1 w-full p-2 border border-gray-300 rounded-md"
                            >
                                <option value="Básico">Básico ($10/mes)</option>
                                <option value="Pro">Pro ($25/mes)</option>
                                <option value="Premium">Premium ($50/mes)</option>
                            </select>
                        </div>
                        <div>
                            <label className="block text-sm font-medium text-gray-700 required">Contacto:</label>
                            <input
                                type="text"
                                value={formData.contact}
                                onChange={(e) => setFormData({ ...formData, contact: e.target.value })}
                                className="mt-1 w-full p-2 border border-gray-300 rounded-md"
                            />
                            {errors.contact && <p className="text-red-500 text-sm mt-1">{errors.contact}</p>}
                        </div>
                        <div>
                            <label className="block text-sm font-medium text-gray-700">Sitio Web:</label>
                            <input
                                type="url"
                                value={formData.website}
                                onChange={(e) => setFormData({ ...formData, website: e.target.value })}
                                className="mt-1 w-full p-2 border border-gray-300 rounded-md"
                            />
                        </div>
                        <button type="submit" className="w-full bg-blue-600 text-white p-3 rounded-lg hover:bg-blue-700 pulse">Crear Perfil</button>
                    </form>
                </div>
            );
        }

        function AgencyProfilePage() {
            const { id } = useParams();
            const agency = agenciesData.find(a => a.id === parseInt(id));
            if (!agency) return <div className="container mx-auto p-4 fade-in">Inmobiliaria no encontrada</div>;
            const agencyProperties = propertiesData.filter(p => p.agencyId === agency.id);
            return (
                <div className="container mx-auto p-4 fade-in">
                    <h1 className="text-3xl font-bold mb-6 text-blue-900">{agency.name}</h1>
                    <div className="bg-white p-6 rounded-lg shadow-md mb-6">
                        <img src={agency.logo} alt={agency.name} className="w-32 h-32 object-contain mx-auto mb-4" />
                        <p className="text-gray-700 mb-4">{agency.description}</p>
                        <p className="text-gray-600 mb-2"><strong>Plan:</strong> {agency.plan}</p>
                        <p className="text-blue-600 mb-2"><strong>Contacto:</strong> {agency.contact}</p>
                        {agency.website && <a href={agency.website} target="_blank" className="text-blue-500 mb-2 block">Visitar sitio web</a>}
                    </div>
                    <h2 className="text-2xl font-semibold mb-4 text-blue-900">Propiedades de {agency.name}</h2>
                    <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                        {agencyProperties.map(prop => (
                            <div key={prop.id} className="property-card bg-white rounded-lg shadow-lg overflow-hidden flex flex-col">
                                <img src={prop.images[0]} alt={prop.title} className="w-full h-48 object-cover" />
                                <div className="p-4 flex-grow flex flex-col justify-between">
                                    <div>
                                        <span className="inline-block bg-yellow-200 text-yellow-800 text-xs px-2 rounded-full mb-1">{prop.type}</span>
                                        <h3 className="text-xl font-semibold mb-1">{prop.title}</h3>
                                        <p className="text-gray-600 text-sm mb-2">{prop.location}</p>
                                    </div>
                                    <div>
                                        <p className="text-2xl font-bold text-blue-600 mb-3">UYU {prop.price}/mes</p>
                                        <Link to={`/property/${prop.id}`} className="block text-center bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Ver Detalles</Link>
                                    </div>
                                </div>
                            </div>
                        ))}
                    </div>
                    <Link to="/agencies" className="inline-block bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 mt-6">Volver</Link>
                </div>
            );
        }

        function LocalServicesPage() {
            const [services, setServices] = React.useState(servicesData);
            const [formData, setFormData] = React.useState({ name: '', category: '', contact: '', description: '', cityId: 1 });
            const [errors, setErrors] = React.useState({});
            const [selectedCity, setSelectedCity] = React.useState(1);

            const handleSubmit = (e) => {
                e.preventDefault();
                const newErrors = {};
                if (!formData.name) newErrors.name = 'El nombre es obligatorio.';
                if (!formData.category) newErrors.category = 'La categoría es obligatoria.';
                if (!formData.contact) newErrors.contact = 'El contacto es obligatorio.';
                setErrors(newErrors);
                if (Object.keys(newErrors).length > 0) return;
                setServices([...services, { id: Date.now(), ...formData }]);
                setFormData({ name: '', category: '', contact: '', description: '', cityId: 1 });
                alert('Servicio añadido (simulado).');
            };

            return (
                <div className="container mx-auto p-4 fade-in">
                    <h1 className="text-3xl font-bold text-center mb-6 text-blue-900">Directorio de Servicios Locales</h1>
                    <div className="bg-white p-6 rounded-lg shadow-md mb-6">
                        <h2 className="text-2xl font-semibold mb-4">Añadir Servicio</h2>
                        <form onSubmit={handleSubmit} className="space-y-4">
                            <div>
                                <label className="block text-sm font-medium text-gray-700 required">Ciudad:</label>
                                <select
                                    value={formData.cityId}
                                    onChange={(e) => setFormData({ ...formData, cityId: parseInt(e.target.value) })}
                                    className="mt-1 w-full p-2 border border-gray-300 rounded-md"
                                >
                                    {citiesData.map(city => (
                                        <option key={city.id} value={city.id}>{city.name}</option>
                                    ))}
                                </select>
                            </div>
                            <div>
                                <label className="block text-sm font-medium text-gray-700 required">Nombre:</label>
                                <input
                                    type="text"
                                    value={formData.name}
                                    onChange={(e) => setFormData({ ...formData, name: e.target.value })}
                                    className="mt-1 w-full p-2 border border-gray-300 rounded-md"
                                />
                                {errors.name && <p className="text-red-500 text-sm mt-1">{errors.name}</p>}
                            </div>
                            <div>
                                <label className="block text-sm font-medium text-gray-700 required">Categoría:</label>
                                <select
                                    value={formData.category}
                                    onChange={(e) => setFormData({ ...formData, category: e.target.value })}
                                    className="mt-1 w-full p-2 border border-gray-300 rounded-md"
                                >
                                    <option value="">Selecciona</option>
                                    <option value="Plomería">Plomería</option>
                                    <option value="Mudanzas">Mudanzas</option>
                                    <option value="Electricidad">Electricidad</option>
                                </select>
                                {errors.category && <p className="text-red-500 text-sm mt-1">{errors.category}</p>}
                            </div>
                            <div>
                                <label className="block text-sm font-medium text-gray-700 required">Contacto:</label>
                                <input
                                    type="text"
                                    value={formData.contact}
                                    onChange={(e) => setFormData({ ...formData, contact: e.target.value })}
                                    className="mt-1 w-full p-2 border border-gray-300 rounded-md"
                                />
                                {errors.contact && <p className="text-red-500 text-sm mt-1">{errors.contact}</p>}
                            </div>
                            <div>
                                <label className="block text-sm font-medium text-gray-700">Descripción:</label>
                                <textarea
                                    value={formData.description}
                                    onChange={(e) => setFormData({ ...formData, description: e.target.value })}
                                    className="mt-1 w-full p-2 border border-gray-300 rounded-md"
                                    rows="3"
                                ></textarea>
                            </div>
                            <button type="submit" className="w-full bg-blue-600 text-white p-3 rounded-lg hover:bg-blue-700 pulse">Añadir Servicio</button>
                        </form>
                    </div>
                    <div className="mb-4">
                        <label className="block text-sm font-medium text-gray-700">Ciudad:</label>
                        <select
                            value={selectedCity}
                            onChange={(e) => setSelectedCity(parseInt(e.target.value))}
                            className="w-full p-2 border border-gray-300 rounded-md"
                        >
                            {citiesData.map(city => (
                                <option key={city.id} value={city.id}>{city.name}</option>
                            ))}
                        </select>
                    </div>
                    <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                        {services.filter(s => s.cityId === selectedCity).map(service => (
                            <div key={service.id} className="bg-white p-4 rounded-lg shadow-md">
                                <h3 className="text-xl font-semibold">{service.name}</h3>
                                <p className="text-gray-600">{service.category}</p>
                                <p className="text-gray-700">{service.description}</p>
                                <p className="text-blue-600 font-semibold">Contacto: {service.contact}</p>
                            </div>
                        ))}
                    </div>
                </div>
            );
        }

        function NeighborhoodGuidePage() {
            const [selectedCity, setSelectedCity] = React.useState(1);

            React.useEffect(() => {
                neighborhoodsData
                    .filter(n => n.cityId === selectedCity)
                    .forEach(neighborhood => {
                        const map = L.map(`map-${neighborhood.id}`).setView([neighborhood.coordinates.lat, neighborhood.coordinates.lng], 13);
                        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                            attribution: '© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>'
                        }).addTo(map);
                        L.marker([neighborhood.coordinates.lat, neighborhood.coordinates.lng])
                            .addTo(map)
                            .bindPopup(`<b>${neighborhood.name}</b>`)
                            .openPopup();
                    });
            }, [selectedCity]);

            return (
                <div className="container mx-auto p-4 fade-in">
                    <h1 className="text-3xl font-bold text-center mb-6 text-blue-900">Guía de Barrios</h1>
                    <div className="mb-4">
                        <label className="block text-sm font-medium text-gray-700">Ciudad:</label>
                        <select
                            value={selectedCity}
                            onChange={(e) => setSelectedCity(parseInt(e.target.value))}
                            className="w-full p-2 border border-gray-300 rounded-md"
                        >
                            {citiesData.map(city => (
                                <option key={city.id} value={city.id}>{city.name}</option>
                            ))}
                        </select>
                    </div>
                    <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                        {neighborhoodsData.filter(n => n.cityId === selectedCity).map(neighborhood => (
                            <div key={neighborhood.id} className="neighborhood-card bg-white p-4 rounded-lg shadow-md">
                                <h3 className="text-xl font-semibold mb-2">{neighborhood.name}</h3>
                                <p className="text-gray-700 mb-3">{neighborhood.description}</p>
                                <p className="text-gray-600 mb-3"><strong>Servicios:</strong> {neighborhood.amenities.join(', ')}</p>
                                <div id={`map-${neighborhood.id}`} className="h-48 rounded-lg shadow-md"></div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        }

        function PlansPage() {
            return (
                <div className="container mx-auto p-4 fade-in">
                    <h1 className="text-3xl font-bold text-center mb-6 text-blue-900">Planes para Inmobiliarias</h1>
                    <p className="text-center text-gray-600 mb-6">Elige el plan perfecto para tu negocio en Uruguay.</p>
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div className="bg-white p-6 rounded-lg shadow-md text-center">
                            <h2 className="text-2xl font-semibold mb-4">Básico</h2>
                            <p className="text-3xl font-bold text-blue-600 mb-4">$10/mes</p>
                            <ul className="text-gray-700 mb-4">
                                <li>Hasta 5 propiedades</li>
                                <li>Filtros básicos</li>
                                <li>Soporte por email</li>
                            </ul>
                            <button className="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 pulse">Suscribirse</button>
                        </div>
                        <div className="bg-white p-6 rounded-lg shadow-md text-center">
                            <h2 className="text-2xl font-semibold mb-4">Pro</h2>
                            <p className="text-3xl font-bold text-blue-600 mb-4">$25/mes</p>
                            <ul className="text-gray-700 mb-4">
                                <li>Hasta 20 propiedades</li>
                                <li>Filtros avanzados (IA)</li>
                                <li>Integración con CRM</li>
                                <li>Soporte prioritario</li>
                            </ul>
                            <button className="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 pulse">Suscribirse</button>
                        </div>
                        <div className="bg-white p-6 rounded-lg shadow-md text-center">
                            <h2 className="text-2xl font-semibold mb-4">Premium</h2>
                            <p className="text-3xl font-bold text-blue-600 mb-4">$50/mes</p>
                            <ul className="text-gray-700 mb-4">
                                <li>Propiedades ilimitadas</li>
                                <li>Anuncios patrocinados</li>
                                <li>Recomendaciones IA</li>
                                <li>Soporte 24/7</li>
                            </ul>
                            <button className="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 pulse">Suscribirse</button>
                        </div>
                    </div>
                </div>
            );
        }

        function App() {
            return (
                <BrowserRouter>
                    <div className="flex flex-col min-h-screen">
                        <Header />
                        <main className="flex-grow">
                            <Switch>
                                <Route path="/" exact component={HomePage} />
                                <Route path="/property/:id" component={PropertyPage} />
                                <Route path="/list" component={ListPropertyPage} />
                                <Route path="/agencies" exact component={AgenciesPage} />
                                <Route path="/create-agency" component={CreateAgencyPage} />
                                <Route path="/agency/:id" component={AgencyProfilePage} />
                                <Route path="/services" component={LocalServicesPage} />
                                <Route path="/neighborhoods" component={NeighborhoodGuidePage} />
                                <Route path="/plans" component={PlansPage} />
                                <Route path="/login" component={LoginPage} />
                                <Route path="/profile" component={ProfilePage} />
                                <Route path="/admin" component={AdminPage} />
                            </Switch>
                        </main>
                        <Footer />
                    </div>
                </BrowserRouter>
            );
        }

        // Simulated live chat
        function openChat() {
            alert('Conectando con soporte en vivo... (simulado)');
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
